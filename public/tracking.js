
var MapObject = {
    map :null,
    view:null
};

function EnableTrackingMap(mapContainerId){
    require([
        "esri/widgets/Track",
        "esri/views/SceneView",
        "esri/Map",
        "esri/Graphic",
        "dom"
    ], function (Track, SceneView, Map, Graphic) {
    
        $(function () {
            //on document rdy
            var map = new Map({
                basemap: "topo"
            });
    
            var view = new SceneView({
                map: map,
                container: mapContainerId,
                center: [-117.187038, 34.057322],
                zoom: 12,
            });
            //<img src="https://img.icons8.com/color/48/000000/mobile-home.png">
            MapObject.map=map;
            MapObject.view=view;
            var sampleSanDiegoToVegas= "-117.1515572884866,32.71362537802769,-117.13226550014666,32.71389618919445,-117.11984016688581,32.717777725568695,-117.11297371180713,32.734024183666754,-117.11597778590401,32.74142436632218,-117.1103987911536,32.74738016453508,-117.11297371180737,32.767951676500914,-117.11340286524994,32.778776879055165,-117.11597778590391,32.78743609297673,-117.11361744197076,32.79609446399841,-117.12198593409757,32.84297932041575,-117.11275913508636,32.861365851143326,-117.10857488902302,32.872720334153115,-117.11125709803805,32.88263178930212,-117.11812355311604,32.89632579429904,-117.11812355311625,32.91866410011148,-117.11297371180741,32.938835789471966,-117.08379127772531,32.98636513957157,-117.08572246821583,32.998243481347714,-117.0820746639561,33.01012022423341,-117.07520820887733,33.04933809963427,-117.0709166744539,33.06174746012389,-117.07134582789604,33.07343583730489,-117.0732770183874,33.08026832328074,-117.0786414364169,33.08710027855591,-117.1073947170562,33.12700267084433,-117.1035323360754,33.158624119086035,-117.13464596064736,33.21034371871177,-117.14762785227902,33.23475624692956,-117.15889313014195,33.26059737938919,-117.15481617243914,33.27620602720563,-117.1494517544099,33.293964198009796,-117.15224125178501,33.31369126039724,-117.16060974391188,33.33162108077273,-117.1588931301423,33.35922578822939,-117.17155315669264,33.37786297690591,-117.17520096095271,33.39434639216829,-117.13732816966214,33.444494072875656,-117.1356652000728,33.45308790959425,-117.13719405921158,33.469736044833496,-117.14010425599264,33.48074353923042,-117.14623310359227,33.49514960958013,-117.16350652964773,33.52350735136483,-117.17300154956067,33.53696731570413,-117.18077995570377,33.550425184536365,-117.180994532425,33.58832844054502,-117.17176773341428,33.60369954462405,-117.17112400324987,33.68551344925272,-117.18893387110903,33.71300545583539,-117.19043590815724,33.76323595697289,-117.19183065684507,33.766580638188216,-117.20438339503434,33.77474111250202,-117.22283699305699,33.786155553789555,-117.23174192698634,33.79346713079329,-117.2442842018118,33.82536565518021,-117.2587249496768,33.856481283727156,-117.27214232165456,33.8884049697472,-117.28975408264088,33.918051033409874,-117.29014625912338,33.930797495545754,-117.29354049583327,33.9434508122092,-117.30156143964568,33.94721704618155,-117.30755036073964,33.956322150964084,-117.31308383679756,33.95940684399516,-117.32396733319561,33.96186597804352,-117.34014910165786,33.978594697089854,-117.34911137024007,33.98747680689576,-117.35885662606566,33.993319621822984,-117.33411507710126,34.02586809771097,-117.31446792136869,34.042973238686784,-117.30101941244365,34.052475496783316,-117.29750121652066,34.06429637060261,-117.30695106776419,34.13214313969971,-117.31498869576023,34.13710348343037,-117.32072835857348,34.1445895271935,-117.32836931352783,34.15838267004004,-117.34330707205633,34.1754512855762,-117.35099011432303,34.18380645127388,-117.3608147866177,34.19038246789067,-117.38565266456465,34.20910798146852,-117.39646166113381,34.21820559184492,-117.40261614324878,34.22230927137147,-117.41069933234881,34.22534517081064,-117.43113983114601,34.241133541080664,-117.43890116872548,34.247670358024,-117.44856737503139,34.25311057902043,-117.45060838694128,34.25827810207852,-117.4502910841789,34.27235282627749,-117.4526953394069,34.28141461751618,-117.45277430286228,34.29193265991607,-117.46320977820342,34.30410903951647,-117.47788405739084,34.314085942721675,-117.48252371027655,34.32235853599074,-117.48276482228583,34.33947603937858,-117.47681905821844,34.34750081278688,-117.45656428681272,34.34471250889841,-117.44110426467358,34.353716526759506,-117.38131524073714,34.42661935304669,-117.32755043299844,34.50006614304556,-117.31247915997295,34.53621207156661,-117.29146731864586,34.55171565067219,-117.25174932152956,34.60244635324634,-117.21379945007018,34.655235342452045,-117.21159326647552,34.6781858612872,-117.2133095320476,34.688744324329484,-117.18801549603877,34.731437945212555,-117.0992065764586,34.80863404300832,-117.07778312953194,34.87482283573885,-117.05385181954729,34.88518514259285,-117.00568535121177,34.88749669763356,-116.97347421873062,34.90907392593239,-116.90440513880935,34.90016860501402,-116.79969169886827,34.91213472259896,-116.71815254481567,34.930432470312354,-116.57224037440535,34.9972549276265,-116.47353508265775,35.034511135341575,-116.40315391810694,35.07947713489055,-116.32504799159356,35.08720317197942,-116.27097465785296,35.10124863727403,-116.21861793788231,35.13073623826014,-116.15681984217919,35.19318658916243,-116.15596153529431,35.193186589162565,-116.15596153529457,35.1924851662128,-116.12592079432783,35.19879775474554,-116.09244682582195,35.25418719830325,-116.07270576747216,35.26890461208159,-115.9369216183024,35.357292942372965,-115.82362510951329,35.39228536657328,-115.59188225062671,35.47620525151449,-115.52150108607567,35.46502098752316,-115.50948478968942,35.472011334811796,-115.47515251429834,35.46222467847586,-115.4545531490638,35.472011334811874,-115.39275505336055,35.624249803692514,-115.36528923304819,35.738587166724564,-115.2588591793374,35.863890660362564,-115.21321507517737,35.90158444808387,-115.18504478724739,35.951485437001324,-115.18161155970817,36.1263838481918,-115.16444542201323,36.158267804773345,-115.16101219447417,36.17489776778674,-115.14865257533336,36.17642200451552,-115.13320305140743,36.170879183374744,-115.13749458583128,36.164989506332475,-115.14167883189464,36.15920333384373,-115.14886715205482,36.162148445064254,-115.14886715205466,36.162061825725196";
            // var sampleSeattleStr="-122.33164825039103,47.591402833998124,-122.31516875820353,47.59418125694164,-122.3021224935551,47.58955047008315,-122.24993743496142,47.588624263539735,-122.23826446132865,47.59325513235093,-122.20667876796931,47.5770452987674,-122.17165984707093,47.57889810523703,-122.18127288418027,47.603441601384844,-122.18951263027402,47.61686618958172,-122.18539275722715,47.634451813444045,-122.17165984707093,47.62889909769926,-122.17303313808654,47.61779189623237,-122.15586700039124,47.61686618958172";
            // var sampleSanDiegoStr = "-117.16040710068495,32.71635628748923,-117.15903380966934,32.71288993806583,-117.14907744980606,32.7114455860492,-117.145644222267,32.71288993806583,-117.10272887802877,32.71895596115269,-117.09414580918111,32.70335678260539,-117.09517577744285,32.68804382567807,-117.07457641220851,32.656831935544645,-117.04127410507964,32.67041622781221,-117.01243499375157,32.69671185978829,-117.01792815781405,32.7466810978297,-117.01140502548984,32.753033560259894,-117.0151815757828,32.75707580047155,-117.02273467636871,32.75447723853994";
            // var sampleRanchoPathStr = "-117.54733184433688,34.1141890653598,-117.5583181724619,34.1141890653598,-117.55763152695408,34.106514121657234,-117.53394225693455,34.10594557960891,-117.53359893418066,34.10594557960891,-117.4944601402354,34.13863054045183,-117.41892913437609,34.194307955508776,-117.40965942002062,34.2252555215393,-117.34683135605582,34.181244105286495,-117.33344176865347,34.16363310609393,-117.33138183213003,34.17584757671804,-117.31524566269644,34.17840387011694,-117.31455901718863,34.173291205878144,-117.30734923935661,34.173291205878144";
            // var ranchoPath = stringToPath(sampleRanchoPathStr);
            // var sanDiegoPath = stringToPath(sampleSanDiegoStr);
            // var seattlePath = stringToPath(sampleSeattleStr);
            var sanDiegoVegasPath = stringToPath(sampleSanDiegoToVegas);
            // var sampleSeattlePoints = "47.58648398485127,-122.24293761497448,47.592967351573144,-122.32773833518921,47.61842994576939,-122.18079619651752";
            // var sampleRanchoPoints = "34.11650978727171,-117.55478131404597,34.14180305014156,-117.46998059383122,34.17362201752975,-117.30587231746426";
            // var sampleSanDiegoPoints= "32.71345802745813,-117.14814109637452,32.66780549039614,-117.0520107252809,32.73540915865544,-117.02660484149187";
            var sampleSanDiegoVegasPoints = "32.713628996067534,-117.15153291142458,34.13471873440743,-117.3139584183148,36.16212589325606,-115.14869896024746";
            // var ranchoLandMarks = stringToLandMarks(sampleRanchoPoints);
            // var sanDiegoLandMarks = stringToLandMarks(sampleSanDiegoPoints);
            // var seattleLandMarks = stringToLandMarks(sampleSeattlePoints);
            var sanDiegoVegasLandMarks = stringToLandMarks(sampleSanDiegoVegasPoints);

            view.when(function () {
                var markerSymbol = {
                    type: "picture-marker", // autocasts as new PictureMarkerSymbol()
                    url: "https://img.icons8.com/color/24/000000/mobile-home.png",
                    width: "24px",
                    height: "24px"
                };
                var track = new Track({
                    view: view,
                    goToLocationEnabled: true, // disable this since we want to control what happens after our location is acquired
                    graphic: new Graphic({
                        symbol: markerSymbol,
                        scale: 15000
                    }),
    
                });
                view.ui.add(track, "top-left");
                track.start();
                setUI();
                PlotRoute(sanDiegoVegasPath,sanDiegoVegasLandMarks);
                //PlotRoute(ranchoPath,ranchoLandMarks);
                // PlotRoute(sanDiegoPath,sanDiegoLandMarks);
                // PlotRoute(seattlePath,seattleLandMarks);
            });
        });
    });
}

